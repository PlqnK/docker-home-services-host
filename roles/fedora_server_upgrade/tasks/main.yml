---
- name: 'Upgrade OS and reboot'
  when: (containers_list is not defined)
  block:
    - name: 'Upgrade OS'
      ansible.builtin.dnf:
        name: '*'
        state: 'latest'
      notify: 'Reboot host'
      tags: ['never', 'os-upgrade']

    - name: 'Reboot host if OS has been upgraded'
      ansible.builtin.meta: 'flush_handlers'
      tags: ['never', 'os-reboot']
