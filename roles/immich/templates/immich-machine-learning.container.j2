[Unit]
Description=Immich Machine Learning
Documentation=man:podman-systemd.unit(5)
Wants=network-online.target
After=network-online.target

[Container]
ContainerName=immich-machine-learning
Image={{ containers_images.immich.machine_learning }}:{{ containers_images_tags.immich.machine_learning }}
Network=web-egress
Network=immich-server-internal
ExposeHostPort=3003
Volume={{ containers_storage_path }}/runtime/immich-machine-learning:/cache:Z
Timezone={{ timezone }}
Environment="TZ={{ timezone }}"
Environment="IMMICH_SERVER_URL=http://immich-server:3001"
HealthCmd="python3 healthcheck.py"
HealthInterval=10s
HealthTimeout=3s
HealthRetries=3
Notify=healthy

[Service]
Restart=on-failure
TimeoutStopSec=70

[Install]
WantedBy=default.target
