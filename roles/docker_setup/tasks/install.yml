---
- name: 'Install docker, docker-compose and ansible dependencies'
  ansible.builtin.dnf:
    name:
      - 'moby-engine'
      - 'docker-compose'
      - 'python3-docker'
    state: 'present'

- name: 'Enable and configure IPv6 NAT'
  ansible.builtin.template:
    src: 'daemon.json.j2'
    dest: '/etc/docker/daemon.json'
    owner: 'root'
    group: 'root'
    mode: '0644'
  when: docker_ipv6.enabled
  notify: restart_docker

- name: 'Enable and start the docker service'
  ansible.builtin.systemd:
    name: 'docker.service'
    enabled: true
    state: 'started'

- name: 'Flush handlers'
  meta: flush_handlers
